{"version":3,"file":"get-obj-schema.js","names":["_schema","require","getOBJSchema","attributes","metadata","arguments","length","undefined","metadataMap","key","Map","set","JSON","stringify","fields","attributeName","attribute","field","getArrowFieldFromAttribute","push","Schema","type","getArrowTypeFromTypedArray","value","isSingleValue","size","Field","FixedSizeList"],"sources":["../../../src/lib/get-obj-schema.ts"],"sourcesContent":["import {Schema, Field, FixedSizeList, getArrowTypeFromTypedArray} from '@loaders.gl/schema';\n\nexport function getOBJSchema(attributes, metadata = {}) {\n  let metadataMap;\n  for (const key in metadata) {\n    metadataMap = metadataMap || new Map();\n    if (key !== 'value') {\n      metadataMap.set(key, JSON.stringify(metadata[key]));\n    }\n  }\n\n  const fields: Field[] = [];\n  for (const attributeName in attributes) {\n    const attribute = attributes[attributeName];\n    const field = getArrowFieldFromAttribute(attributeName, attribute);\n    fields.push(field);\n  }\n  return new Schema(fields, metadataMap);\n}\n\nfunction getArrowFieldFromAttribute(attributeName, attribute) {\n  const metadataMap = new Map();\n  for (const key in attribute) {\n    if (key !== 'value') {\n      metadataMap.set(key, JSON.stringify(attribute[key]));\n    }\n  }\n\n  const type = getArrowTypeFromTypedArray(attribute.value);\n  const isSingleValue = !('size' in attribute) || attribute.size === 1;\n  return isSingleValue\n    ? new Field(attributeName, type, false, metadataMap)\n    : new Field(\n      attributeName,\n      new FixedSizeList(attribute.size, new Field('value', type)),\n      false,\n      metadataMap\n    );\n}\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AAEO,SAASC,YAAYA,CAACC,UAAU,EAAiB;EAAA,IAAfC,QAAQ,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,CAAC,CAAC;EACpD,IAAIG,WAAW;EACf,KAAK,IAAMC,GAAG,IAAIL,QAAQ,EAAE;IAC1BI,WAAW,GAAGA,WAAW,IAAI,IAAIE,GAAG,CAAC,CAAC;IACtC,IAAID,GAAG,KAAK,OAAO,EAAE;MACnBD,WAAW,CAACG,GAAG,CAACF,GAAG,EAAEG,IAAI,CAACC,SAAS,CAACT,QAAQ,CAACK,GAAG,CAAC,CAAC,CAAC;IACrD;EACF;EAEA,IAAMK,MAAe,GAAG,EAAE;EAC1B,KAAK,IAAMC,aAAa,IAAIZ,UAAU,EAAE;IACtC,IAAMa,SAAS,GAAGb,UAAU,CAACY,aAAa,CAAC;IAC3C,IAAME,KAAK,GAAGC,0BAA0B,CAACH,aAAa,EAAEC,SAAS,CAAC;IAClEF,MAAM,CAACK,IAAI,CAACF,KAAK,CAAC;EACpB;EACA,OAAO,IAAIG,cAAM,CAACN,MAAM,EAAEN,WAAW,CAAC;AACxC;AAEA,SAASU,0BAA0BA,CAACH,aAAa,EAAEC,SAAS,EAAE;EAC5D,IAAMR,WAAW,GAAG,IAAIE,GAAG,CAAC,CAAC;EAC7B,KAAK,IAAMD,GAAG,IAAIO,SAAS,EAAE;IAC3B,IAAIP,GAAG,KAAK,OAAO,EAAE;MACnBD,WAAW,CAACG,GAAG,CAACF,GAAG,EAAEG,IAAI,CAACC,SAAS,CAACG,SAAS,CAACP,GAAG,CAAC,CAAC,CAAC;IACtD;EACF;EAEA,IAAMY,IAAI,GAAG,IAAAC,kCAA0B,EAACN,SAAS,CAACO,KAAK,CAAC;EACxD,IAAMC,aAAa,GAAG,EAAE,MAAM,IAAIR,SAAS,CAAC,IAAIA,SAAS,CAACS,IAAI,KAAK,CAAC;EACpE,OAAOD,aAAa,GAChB,IAAIE,aAAK,CAACX,aAAa,EAAEM,IAAI,EAAE,KAAK,EAAEb,WAAW,CAAC,GAClD,IAAIkB,aAAK,CACTX,aAAa,EACb,IAAIY,qBAAa,CAACX,SAAS,CAACS,IAAI,EAAE,IAAIC,aAAK,CAAC,OAAO,EAAEL,IAAI,CAAC,CAAC,EAC3D,KAAK,EACLb,WACF,CAAC;AACL"}